{% extends 'base.html' %}
{% block title %}{{ book.name }}{% endblock %}

{% block content %}

<div class="mb-3 d-flex justify-content-between">
  <a href="{% url 'biblecheck_youth:book_list' %}" class="btn btn-outline-secondary btn-sm">â† ì‹ êµ¬ì•½ ì„ íƒìœ¼ë¡œ</a>

  <div>
    <a href="{% url 'biblecheck_youth:today_checked' %}" class="btn btn-outline-success btn-sm me-2">ğŸ“† ì˜¤ëŠ˜ ì²´í¬</a>
    <a href="{% url 'biblecheck_youth:history_checked' %}" class="btn btn-outline-primary btn-sm">ğŸ“š íˆìŠ¤í† ë¦¬</a>
  </div>
</div>

<div class="text-center mb-4">
  <h2>{{ book.name }}</h2>
  <p class="text-muted">ì½ì€ ì¥ì„ ì„ íƒí•˜ê³  ì²´í¬í•˜ì„¸ìš”.</p>
</div>

<form method="post" action="{% url 'biblecheck_youth:check_chapter' book.id %}" id="chapter-form">
  {% csrf_token %}
  <input type="hidden" name="selected_chapters" id="selected-chapters">

  <div class="d-flex flex-wrap justify-content-center gap-2">
    {% for chapter in chapters %}
      {% if chapter in checked_chapters %}
        <!-- ì´ë¯¸ ì²´í¬ëœ ì¥: ì´ˆë¡ìƒ‰ + ë¹„í™œì„±í™” -->
        <button type="button" class="btn btn-success" disabled>{{ chapter }}</button>
      {% else %}
        <!-- ì„ íƒ ê°€ëŠ¥í•œ ì¥ -->
        <button type="button"
                class="btn btn-outline-secondary selectable-chapter"
                data-chapter="{{ chapter }}">
          {{ chapter }}
        </button>
      {% endif %}
    {% endfor %}
  </div>

  <div class="text-center mt-4">
    <button type="submit" class="btn btn-primary">âœ… ì²´í¬í•˜ê¸°</button>
  </div>
</form>
{% endblock %}

{% block script %}
<script>
document.addEventListener('DOMContentLoaded', function () {
  const buttons = document.querySelectorAll('.selectable-chapter');
  const selectedInput = document.getElementById('selected-chapters');
  const selected = new Set();

  buttons.forEach(btn => {
    btn.addEventListener('click', () => {
      const chapter = btn.dataset.chapter;

      if (selected.has(chapter)) {
        selected.delete(chapter);
        btn.className = 'btn btn-outline-secondary selectable-chapter';  // âœ… ì „ì²´ í´ë˜ìŠ¤ ë¦¬ì…‹
      } else {
        selected.add(chapter);
        btn.className = 'btn btn-primary selectable-chapter';  // âœ… ì „ì²´ í´ë˜ìŠ¤ ë¦¬ì…‹
      }

      selectedInput.value = Array.from(selected).join(',');
    });
  });
});


</script>
{% endblock %}

