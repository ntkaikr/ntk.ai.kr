{% extends 'base.html' %}
{% block title %}{{ card.user.username }}ë‹˜ì˜ ëª…í•¨ - Carded{% endblock %}
{% block content %}

<!-- ğŸ”¹ ìƒë‹¨ ë²„íŠ¼ë°” -->
<div class="d-flex justify-content-between mb-3">
  {% if user.is_authenticated and user.username == card.user.username %}
    <a href="{% url 'carded:my_card' %}" class="btn btn-outline-primary">ğŸ›  ì¹´ë“œ ê´€ë¦¬</a>
  {% else %}
    <span></span>  <!-- ì¢Œì¸¡ ê³µê°„ ìœ ì§€ (ì›í•˜ë©´ ì‚­ì œ ê°€ëŠ¥) -->
  {% endif %}
  <button class="btn btn-outline-secondary" onclick="copyLink()">ğŸ”— ì¹´ë“œ ê³µìœ  ë§í¬ ë³µì‚¬</button>
</div>

<!-- âœ… Bootstrap alert ì•Œë¦¼ -->
<div id="copy-alert" class="alert alert-success text-center d-none" role="alert" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 9999;">
  ğŸ“‹ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!
</div>

<!-- ğŸ”¹ ëª…í•¨ ì¹´ë“œ -->
<div class="card mx-auto shadow-lg" style="max-width: 500px;">

  {% if card.images.all %}
    <img src="{{ card.images.first.image.url }}" class="card-img-top" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">
  {% endif %}

  <div class="card-body text-center">
    <h4 class="card-title">{{ card.user.username }}</h4>
    {% if card.tagline %}
      <p class="text-muted">{{ card.tagline }}</p>
    {% endif %}
    {% if card.bio %}
      <p class="card-text">{{ card.bio }}</p>
    {% endif %}

    <hr>
    <h6 class="text-muted">ğŸ“ SNS / ë§í¬</h6>
    <ul class="list-unstyled">
      {% for link in social_links %}
        <li class="mb-2">
          {% if link.favicon_url %}
            <img src="{{ link.favicon_url }}" width="16" height="16" class="me-1">
          {% endif %}
          <a href="{{ link.url }}" target="_blank">{{ link.label }}</a>
        </li>
      {% endfor %}
    </ul>
  </div>
</div>

<!-- ğŸ”¹ í´ë¦½ë³´ë“œ ë³µì‚¬ + ìŠ¤ë‚µë°” ì•Œë¦¼ ìŠ¤í¬ë¦½íŠ¸ -->
<script>
function copyLink() {
  // ğŸ”— í•­ìƒ username ê¸°ë°˜ ê³ ì • ê³µìœ  ë§í¬ ìƒì„±
  const username = "{{ card.user.username }}";
  const link = `${window.location.origin}/carded/${username}/`;

  // ğŸ“‹ í´ë¦½ë³´ë“œ ë³µì‚¬
  const dummy = document.createElement('input');
  dummy.value = link;
  document.body.appendChild(dummy);
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);

  // âœ… Bootstrap ìŠ¤ë‚µë°” ìŠ¤íƒ€ì¼ ì•Œë¦¼ í‘œì‹œ
  const alertBox = document.getElementById('copy-alert');
  if (alertBox) {
    alertBox.classList.remove('d-none');
    setTimeout(() => alertBox.classList.add('d-none'), 2000);
  } else {
    alert('ğŸ“‹ ì¹´ë“œ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
  }
}
</script>



{% endblock %}
